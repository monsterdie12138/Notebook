
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
      
      <link rel="icon" href="../../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.44">
    
    
      
        <title>Chapter4 - Monsterdie's Notebook</title>
      
    
    
      <link rel="stylesheet" href="../../assets/stylesheets/main.0253249f.min.css">
      
        
        <link rel="stylesheet" href="../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    

      
    
<script>
    MathJax = {
        tex: {
            inlineMath: [['$', '$'], ['\\(', '\\)']]
        }
    };
</script>
<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
</script>

    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Times+New+Roman:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Times New Roman";--md-code-font:"Roboto Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#chapter4-hazard" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../.." title="Monsterdie&#39;s Notebook" class="md-header__button md-logo" aria-label="Monsterdie's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Monsterdie's Notebook
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Chapter4
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="default" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a4 4 0 0 0-4 4 4 4 0 0 0 4 4 4 4 0 0 0 4-4 4 4 0 0 0-4-4m0 10a6 6 0 0 1-6-6 6 6 0 0 1 6-6 6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="" data-md-color-scheme="slate" data-md-color-primary="white" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 18c-.89 0-1.74-.2-2.5-.55C11.56 16.5 13 14.42 13 12s-1.44-4.5-3.5-5.45C10.26 6.2 11.11 6 12 6a6 6 0 0 1 6 6 6 6 0 0 1-6 6m8-9.31V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12z"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../.." title="Monsterdie&#39;s Notebook" class="md-nav__button md-logo" aria-label="Monsterdie's Notebook" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Monsterdie's Notebook
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    主页
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    高级数据结构与算法分析
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            高级数据结构与算法分析
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章：AVL树，Splay树与均摊分析
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章：红黑树与B+树
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章：左式堆与斜堆
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章：倒排索引
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第五章：二项堆
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第六章：回溯法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第七章：分治法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第八章：动态规划
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章：贪心算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十章：NP完全性
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十一章：近似算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十二章：局部搜索
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十三章：随机算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十四章：并行算法
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Advanced%20Data%20Structures%20and%20Algorithm%20Analysis/Chapter15/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十五章：外部排序
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    数学分析Ⅱ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            数学分析Ⅱ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter12/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十二章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter13/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter14/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十四章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Mathematical%20Analysis2/Chapter16/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十六章
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" >
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    线性代数Ⅱ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            线性代数Ⅱ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第五章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第六章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第七章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第八章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Linear%20Algebra2/plus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    补充
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_5" >
        
          
          <label class="md-nav__link" for="__nav_5" id="__nav_5_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    离散数学理论基础
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            离散数学理论基础
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第五章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第六章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第八章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter10/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/Chapter11/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第十一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Discrete%20Mathematics/plus/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    补充
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_6" >
        
          
          <label class="md-nav__link" for="__nav_6" id="__nav_6_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    普通物理学Ⅰ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_6_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_6">
            <span class="md-nav__icon md-icon"></span>
            普通物理学Ⅰ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics1/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics1/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_7" >
        
          
          <label class="md-nav__link" for="__nav_7" id="__nav_7_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    普通物理学Ⅱ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_7_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_7">
            <span class="md-nav__icon md-icon"></span>
            普通物理学Ⅱ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter5/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第五章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter6/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第六章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter7/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第七章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第八章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Physics2/Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_8" >
        
          
          <label class="md-nav__link" for="__nav_8" id="__nav_8_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    概率论
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_8_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_8">
            <span class="md-nav__icon md-icon"></span>
            概率论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Probability/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Probability/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Probability/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../Probability/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_9" >
        
          
          <label class="md-nav__link" for="__nav_9" id="__nav_9_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    人工智能引论
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_9_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_9">
            <span class="md-nav__icon md-icon"></span>
            人工智能引论
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AID/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章：逻辑与推理
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AID/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章：搜索与求解
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AID/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章：机器学习
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../AID/Chapter4/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第四章：深度学习
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_10" >
        
          
          <label class="md-nav__link" for="__nav_10" id="__nav_10_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    计算机系统Ⅱ
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_10_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_10">
            <span class="md-nav__icon md-icon"></span>
            计算机系统Ⅱ
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter8/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第八章：OS Structures
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Chapter9/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第九章：Processes
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_11" >
        
          
          <label class="md-nav__link" for="__nav_11" id="__nav_11_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    CSAPP
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_11_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_11">
            <span class="md-nav__icon md-icon"></span>
            CSAPP
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CSAPP/Chapter1/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第一章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CSAPP/Chapter2/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第二章
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../CSAPP/Chapter3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    第三章
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#41-structural-hazard" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Structural Hazard 结构冲突
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#42-data-hazard" class="md-nav__link">
    <span class="md-ellipsis">
      4.2 Data Hazard 数据冲突
    </span>
  </a>
  
    <nav class="md-nav" aria-label="4.2 Data Hazard 数据冲突">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#_1" class="md-nav__link">
    <span class="md-ellipsis">
      简单数据冲突
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#_2" class="md-nav__link">
    <span class="md-ellipsis">
      双重数据冲突
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#load" class="md-nav__link">
    <span class="md-ellipsis">
      Load数据冲突
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#43-control-hazard" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Control Hazard 控制冲突
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  


<p><span style="font-family: 'Times New Roman';"></p>
<h1 id="chapter4-hazard">Chapter4 Hazard</h1>
<hr />
<h2 id="41-structural-hazard">4.1 Structural Hazard 结构冲突</h2>
<p><strong>Problem：</strong></p>
<p>某个硬件资源在一个周期内被多条指令请求。</p>
<blockquote>
<p><strong>例：</strong>
在同一个时钟周期内访问内存（一条指令取数据，一条指令取指令），但在冯诺依曼架构下，指令内存和数据内存为同一个，只有一个输出端。
<img alt="alt text" src="../image/4.1.jpg" /></p>
</blockquote>
<p><strong>Solution：</strong></p>
<ul>
<li>让指令轮流使用硬件资源，部分指令需要stall；</li>
<li>增加硬件资源（一直可以解决结构冲突）。</li>
</ul>
<hr />
<h2 id="42-data-hazard">4.2 Data Hazard 数据冲突</h2>
<p><strong>Problem：</strong></p>
<p>某条指令的操作与前面指令的读写结果相关联。</p>
<blockquote>
<p><strong>例：</strong>
<code>add x1,x2,x3</code>
<code>sub x4,x1,x5</code>
<code>sub</code>指令的<code>x1</code>寄存器的值需要<code>add</code>指令先计算出来。
<img alt="alt text" src="../image/4.2.jpg" /></p>
</blockquote>
<p><strong>Solution：</strong></p>
<p>使用<strong>forwarding 前递</strong>，增加额外硬件，提前取出接下来需要的数据。</p>
<h3 id="_1">简单数据冲突</h3>
<p><strong>Detecting：</strong></p>
<ul>
<li>前一条指令的目的操作数和后一条指令的源操作数冲突
  <code>EX/MEM.rd==ID/EX.rs1</code>（相邻R-type）
  <code>EX/MEM.rd==ID/EX.rs2</code>（相邻R-type）
  <code>MEM/WB.rd==ID/EX.rs1</code>（隔一行的R-type或Load）
  <code>MEM/WB.rd==ID/EX.rs2</code>（隔一行的R-type或Load）</li>
<li>上一条指令涉及写回（例如其他没有冲突的指令，其译码出的立即数也可能恰好等于后面指令的源操作数，从而引发冲突信号）
  <code>EX/MEM.we_reg==1</code>（相邻R-type）
  <code>MEM/WB.we_reg==1</code>（隔一行的R-type或Load）</li>
<li><code>rd</code>不为<code>x0</code>（无效写入）
  <code>EX/MEM.rd!=0</code>（相邻R-type）
  <code>MEM/WB.rd!=0</code>（隔一行的R-type或Load）</li>
</ul>
<p><strong>Forwarding Paths：</strong></p>
<p><img alt="alt text" src="../image/4.10.jpg" /></p>
<p><strong>Forwarding Conditions：</strong></p>
<p><img alt="alt text" src="../image/4.4.jpg" />
<img alt="alt text" src="../image/4.5.jpg" /></p>
<p><strong>Example：</strong></p>
<p><img alt="alt text" src="../image/4.6.jpg" /></p>
<p>第一条指令和第二条指令：<strong>EX冲突</strong>
<code>(EX/MEM.rd==ID/EX.rs1)&amp;&amp;(EX/MEM.we_reg==1)&amp;&amp;(EX/MEM.rd!=0)</code>
对应选择：<code>ForwardA==10</code></p>
<p>第一条指令和第三条指令：<strong>MEM冲突</strong>
<code>(MEM/WB.rd==ID/EX.rs1)&amp;&amp;(MEM/WB.we_reg==1)&amp;&amp;(MEM/WB.rd!=0)</code>
对应选择：<code>ForwardA==01</code></p>
<h3 id="_2">双重数据冲突</h3>
<p><code>add x1,x1,x2</code>
<code>add x1,x1,x3</code>
<code>add x1,x1,x4</code></p>
<p>与之前情况不同的是，第三条指令的<code>rs1</code>在第一条和第二条指令中均作为<code>rd</code>存在，倘若使用上面的判断方法，则会同时触发EX冲突和MEM冲突，但实际上需要的是来自第二条指令的结果，因此，有必要引入新的判断条件来处理双重数据冲突：<strong>出现MEM冲突的同时不能有EX冲突，否则MEM冲突不成立</strong>。</p>
<p><img alt="alt text" src="../image/4.7.jpg" /></p>
<p><strong>对MEM冲突判断的修正：</strong>
<code>(MEM/WB.rd==ID/EX.rs1)&amp;&amp;(MEM/WB.we_reg==1)&amp;&amp;(MEM/WB.rd!=0)&amp;&amp;not[(EX/MEM.rd==ID/EX.rs1)&amp;&amp;(EX/MEM.we_reg==1)&amp;&amp;(EX/MEM.rd!=0)]</code></p>
<p>中括号内是EX冲突的判断条件，请注意前面的<code>not</code>。</p>
<p><strong>Forwarding Paths：</strong></p>
<p><img alt="alt text" src="../image/4.11.jpg" /></p>
<h3 id="load">Load数据冲突</h3>
<p><code>ld x2,20(x1)</code>
<code>and x4,x2,x5</code></p>
<p>此时的情况又与之前不同，<code>ld</code>指令载入<code>x2</code>的数据要在MEM阶段运行结束后得到，但下一条<code>and</code>指令同时进入EXE阶段，<code>x2</code>的数据要作为运行开始的输入，二者产生无法用forwarding解决的矛盾，因此：针对这种情况要有新的判断，解决方法为<strong>stall一个时钟周期</strong>。</p>
<p><img alt="alt text" src="../image/4.8.jpg" /></p>
<p><strong>判断修正：</strong></p>
<p><code>(ID/EX.MemRead==1)&amp;&amp;(ID/EX.rd==IF/ID.rs1)</code></p>
<ul>
<li>第一个判断点：上一条指令是load指令</li>
<li>第二个判断点：前后两条指令使用的寄存器相同</li>
</ul>
<blockquote>
<p>此时信号取<code>ID/EX.rd==IF/ID.rs1</code>而不是<code>EX/MEM.rd==ID/EX.rs1</code>的原因：
如果是后者，那么判断在<code>and</code>指令的EX阶段给出，错误的数据已经在ALU中计算出来并等待下一个时钟周期流到EX/MEM寄存器，当判断在下一个时钟周期上升沿起到stall的作用时，这一瞬间错误的计算结果会传入EX/MEM寄存器，所以会导致stall没起到拦截的作用。</p>
<p>不需要判断<code>ID/EX.rd!=0</code>的原因：
load指令不会将数据载入<code>x0</code>寄存器。</p>
<p>不需要判断<code>ID/EX.we_reg==1</code>的原因：
load指令的寄存器写使能信号一直为0。</p>
</blockquote>
<p><strong>stall具体操作：</strong></p>
<ul>
<li>将ID/EX寄存器置为0</li>
<li>将IF/ID寄存器置为原本ID/EX寄存器的内容（Using instruction is decoded again）</li>
<li>将pc的值置为<code>and</code>指令的下一条指令（Following instruction is fetched again）</li>
</ul>
<p>stall一个周期之后可以与之前一样使用forwarding。</p>
<p><strong>Forwarding Paths：</strong></p>
<p><img alt="alt text" src="../image/4.3.jpg" /></p>
<p><strong>软硬协同：</strong> </p>
<p>stall时不一定要补一个bubble，可以把接下来某一个完全独立的指令先拿过来执行一下，防止影响性能效率。</p>
<hr />
<h2 id="43-control-hazard">4.3 Control Hazard 控制冲突</h2>
<p><strong>Problem：</strong></p>
<p>遇到需要跳转的指令（B型或J型），影响指令的执行流。</p>
<blockquote>
<p><strong>例：</strong>
<code>beq</code>指令在EXE阶段才会出来结果，决定是否跳转，但在这之前已经有新的指令载入。
<img alt="alt text" src="../image/4.9.jpg" /></p>
</blockquote>
<p><strong>Solution：</strong></p>
<p>当遇到Branch指令时，在其跳转结果出来之前都不再载入新的指令。</p>
<p><img alt="alt text" src="../image/4.12.jpg" /></p>
<p>假如Branch指令在MEM阶段得到结果，这样会导致很多的stall，因此还可以考虑在ID阶段增加硬件（target address adder和register comparator），提前进行比较。在ID阶段得到结果不需要stall。</p>
<p><strong>Forwarding Paths：</strong></p>
<p><img alt="alt text" src="../image/4.13.jpg" /></p>
<p><strong>Data Hazards for Branches：</strong></p>
<p>如果将分支判断提前到ID阶段，则之前的数据冲突的解决方法不再适用，因为之前的源操作数在EX阶段才使用，这里相当于又提前了一个周期。</p>
<p>当Branch指令的上上条指令、上上上条指令为R-type，且目标操作数与源操作数一致时，则依然可以用forwarding解决。</p>
<p><img alt="alt text" src="../image/4.14.jpg" /></p>
<p>当Branch指令的上一条指令为R-type，或者上上条指令为Load，且目标操作数与源操作数一致时，无法直接forwarding，需要一个stall。</p>
<p><img alt="alt text" src="../image/4.15.jpg" /></p>
<p>当Branch指令的上一条指令为Load，且目标操作数与源操作数一致时，无法直接forwarding，需要两个stall。</p>
<p><img alt="alt text" src="../image/4.16.jpg" /></p>
<p>综上，就算硬件实现在ID阶段就进行分支跳转的检测，当遇到数据冲突时依然有可能需要stall，只是减少了stall的数量而已。</p>
<p><strong>Branch Delay Slot：</strong></p>
<p>对Branch指令的分支跳转进行预测，只有预测失败才会stall。在RISC-Ⅴ中，一般预测不会跳转，也就是Branch指令之后的指令依然流入流水线。</p>
<p>假如我们如上进行预测，当结果为需要跳转时，Branch指令的下一条指令已经进入了流水线，如果将其stall住，则相当于浪费了一个周期。</p>
<p><img alt="alt text" src="../image/4.17.jpg" /></p>
<p>因此，我们的考虑是，既然Branch指令进入流水线到出现分支跳转结果前，一定有接下来的指令会流入流水线，无论是否正确，那么，为什么不在Branch指令之后放一些无论如何都要执行的指令呢？</p>
<p>于是设置延迟槽，无论之后是否需要跳转，延迟槽里的指令都会在Branch指令之后进入流水线。</p>
<p>以下为三种延迟槽的调度方法：</p>
<p><img alt="alt text" src="../image/4.18.jpg" /></p>
<p><img alt="alt text" src="../image/4.19.jpg" /></p>
<div class="admonition warning 存疑">
<p class="admonition-title">Warning</p>
<p>从前调度可以理解，但从对象调度和从失败处调度难以理解。</p>
</div>
<p><strong>Dynamic Branch Prediction：</strong></p>
<ul>
<li>每次执行Branch指令时，将是否跳转以及跳转地址等信息储存在<strong>branch history table</strong>中</li>
<li>当下一次遇到Branch指令时，会根据branch history table上一次的记录来作出预测，并预取对应的指令</li>
<li>如果预测错误，则flush掉流水线并修改branch history table</li>
</ul>
<p><strong>1-Bit Predictor：</strong></p>
<p><img alt="alt text" src="../image/4.20.jpg" /></p>
<blockquote>
<p>注意：这里的success指的是发生跳转，failure指的是不发生跳转。</p>
</blockquote>
<p>但是，在以下情况时，1-bit predictor一定预测错。考虑双重循环，内循环的最后一次判断一定会出错，因为之前一直判断仍然跳转到内循环，但最后一次判断会跳出内循环，继续到外循环；内循环的第一次判断也一定会出错，因为上一次刚从内循环跳出。</p>
<p><strong>2-Bit Predictor：</strong></p>
<p>只有连续两次预测出错才会改变预测。</p>
<p><img alt="alt text" src="../image/4.21.jpg" /></p>
<p>这样，针对上面双重循环的例子，只会有一次预测出错，即内循环的最后一次判断。</p>
<p><strong>Branch-Target Buffers：</strong></p>
<p>类似于一个缓存，index为之前出现过的Branch指令，content为对应的B型指令上一次的跳转地址（或者PC+4）。当下一次有Branch指令时，可以查表来进行预测，有利于减少重复计算的时延。</p>
<p><img alt="alt text" src="../image/4.22.jpg" /></p>
<p><strong>Integrated Instruction Fetch Units：</strong></p>
<p>整合以下功能：</p>
<ul>
<li>分支预测</li>
<li>指令预取</li>
<li>指令访存和缓冲</li>
</ul>












                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    <script id="__config" type="application/json">{"base": "../..", "features": [], "search": "../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}}</script>
    
    
      <script src="../../assets/javascripts/bundle.83f73b43.min.js"></script>
      
    
  </body>
</html>